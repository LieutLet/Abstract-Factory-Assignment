Refactored a tightly coupled program to match the abstract factory design pattern
